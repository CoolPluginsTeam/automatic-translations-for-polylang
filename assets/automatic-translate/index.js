(()=>{"use strict";var t={520:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getProperty=e.safeStringify=e.stringify=e.strConcat=e.addCodeArg=e.str=e._=e.nil=e._Code=e.Name=e.IDENTIFIER=e._CodeOrName=void 0;class a{}e._CodeOrName=a,e.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class n extends a{constructor(t){if(super(),!e.IDENTIFIER.test(t))throw new Error("CodeGen: name must be a valid identifier");this.str=t}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}e.Name=n;class r extends a{constructor(t){super(),this._items="string"==typeof t?[t]:t}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const t=this._items[0];return""===t||'""'===t}get str(){var t;return null!==(t=this._str)&&void 0!==t?t:this._str=this._items.reduce(((t,e)=>`${t}${e}`),"")}get names(){var t;return null!==(t=this._names)&&void 0!==t?t:this._names=this._items.reduce(((t,e)=>(e instanceof n&&(t[e.str]=(t[e.str]||0)+1),t)),{})}}function s(t,...e){const a=[t[0]];let n=0;for(;n<e.length;)l(a,e[n]),a.push(t[++n]);return new r(a)}e._Code=r,e.nil=new r(""),e._=s;const o=new r("+");function i(t,...e){const a=[d(t[0])];let n=0;for(;n<e.length;)a.push(o),l(a,e[n]),a.push(o,d(t[++n]));return function(t){let e=1;for(;e<t.length-1;){if(t[e]===o){const a=c(t[e-1],t[e+1]);if(void 0!==a){t.splice(e-1,3,a);continue}t[e++]="+"}e++}}(a),new r(a)}function l(t,e){var a;e instanceof r?t.push(...e._items):e instanceof n?t.push(e):t.push("number"==typeof(a=e)||"boolean"==typeof a||null===a?a:d(Array.isArray(a)?a.join(","):a))}function c(t,e){if('""'===e)return t;if('""'===t)return e;if("string"==typeof t){if(e instanceof n||'"'!==t[t.length-1])return;return"string"!=typeof e?`${t.slice(0,-1)}${e}"`:'"'===e[0]?t.slice(0,-1)+e.slice(1):void 0}return"string"!=typeof e||'"'!==e[0]||t instanceof n?void 0:`"${t}${e.slice(1)}`}function d(t){return JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}e.str=i,e.addCodeArg=l,e.strConcat=function(t,e){return e.emptyStr()?t:t.emptyStr()?e:i`${t}${e}`},e.stringify=function(t){return new r(d(t))},e.safeStringify=d,e.getProperty=function(t){return"string"==typeof t&&e.IDENTIFIER.test(t)?new r(`.${t}`):s`[${t}]`}},29:(t,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.or=e.and=e.not=e.CodeGen=e.operators=e.varKinds=e.ValueScopeName=e.ValueScope=e.Scope=e.Name=e.stringify=e.getProperty=e.nil=e.strConcat=e.str=e._=void 0;const n=a(520),r=a(845);var s=a(520);Object.defineProperty(e,"_",{enumerable:!0,get:function(){return s._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return s.str}}),Object.defineProperty(e,"strConcat",{enumerable:!0,get:function(){return s.strConcat}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return s.nil}}),Object.defineProperty(e,"getProperty",{enumerable:!0,get:function(){return s.getProperty}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return s.stringify}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return s.Name}});var o=a(845);Object.defineProperty(e,"Scope",{enumerable:!0,get:function(){return o.Scope}}),Object.defineProperty(e,"ValueScope",{enumerable:!0,get:function(){return o.ValueScope}}),Object.defineProperty(e,"ValueScopeName",{enumerable:!0,get:function(){return o.ValueScopeName}}),Object.defineProperty(e,"varKinds",{enumerable:!0,get:function(){return o.varKinds}}),e.operators={GT:new n._Code(">"),GTE:new n._Code(">="),LT:new n._Code("<"),LTE:new n._Code("<="),EQ:new n._Code("==="),NEQ:new n._Code("!=="),NOT:new n._Code("!"),OR:new n._Code("||"),AND:new n._Code("&&"),ADD:new n._Code("+")};class i{optimizeNodes(){return this}optimizeNames(t,e){return this}}class l extends i{constructor(t,e,a){super(),this.varKind=t,this.name=e,this.rhs=a}render({es5:t,_n}){const e=t?r.varKinds.var:this.varKind,a=void 0===this.rhs?"":` = ${this.rhs}`;return`${e} ${this.name}${a};`+_n}optimizeNames(t,e){if(t[this.name.str])return this.rhs&&(this.rhs=L(this.rhs,t,e)),this}get names(){return this.rhs instanceof n._CodeOrName?this.rhs.names:{}}}class c extends i{constructor(t,e,a){super(),this.lhs=t,this.rhs=e,this.sideEffects=a}render({_n}){return`${this.lhs} = ${this.rhs};`+_n}optimizeNames(t,e){if(!(this.lhs instanceof n.Name)||t[this.lhs.str]||this.sideEffects)return this.rhs=L(this.rhs,t,e),this}get names(){return j(this.lhs instanceof n.Name?{}:{...this.lhs.names},this.rhs)}}class d extends c{constructor(t,e,a,n){super(t,a,n),this.op=e}render({_n}){return`${this.lhs} ${this.op}= ${this.rhs};`+_n}}class u extends i{constructor(t){super(),this.label=t,this.names={}}render({_n}){return`${this.label}:`+_n}}class p extends i{constructor(t){super(),this.label=t,this.names={}}render({_n}){return`break${this.label?` ${this.label}`:""};`+_n}}class h extends i{constructor(t){super(),this.error=t}render({_n}){return`throw ${this.error};`+_n}get names(){return this.error.names}}class m extends i{constructor(t){super(),this.code=t}render({_n}){return`${this.code};`+_n}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(t,e){return this.code=L(this.code,t,e),this}get names(){return this.code instanceof n._CodeOrName?this.code.names:{}}}class g extends i{constructor(t=[]){super(),this.nodes=t}render(t){return this.nodes.reduce(((e,a)=>e+a.render(t)),"")}optimizeNodes(){const{nodes:t}=this;let e=t.length;for(;e--;){const a=t[e].optimizeNodes();Array.isArray(a)?t.splice(e,1,...a):a?t[e]=a:t.splice(e,1)}return t.length>0?this:void 0}optimizeNames(t,e){const{nodes:a}=this;let n=a.length;for(;n--;){const r=a[n];r.optimizeNames(t,e)||(P(t,r.names),a.splice(n,1))}return a.length>0?this:void 0}get names(){return this.nodes.reduce(((t,e)=>R(t,e.names)),{})}}class f extends g{render(t){return"{"+t._n+super.render(t)+"}"+t._n}}class _ extends g{}class y extends f{}y.kind="else";class b extends f{constructor(t,e){super(e),this.condition=t}render(t){let e=`if(${this.condition})`+super.render(t);return this.else&&(e+="else "+this.else.render(t)),e}optimizeNodes(){super.optimizeNodes();const t=this.condition;if(!0===t)return this.nodes;let e=this.else;if(e){const t=e.optimizeNodes();e=this.else=Array.isArray(t)?new y(t):t}return e?!1===t?e instanceof b?e:e.nodes:this.nodes.length?this:new b($(t),e instanceof b?[e]:e.nodes):!1!==t&&this.nodes.length?this:void 0}optimizeNames(t,e){var a;if(this.else=null===(a=this.else)||void 0===a?void 0:a.optimizeNames(t,e),super.optimizeNames(t,e)||this.else)return this.condition=L(this.condition,t,e),this}get names(){const t=super.names;return j(t,this.condition),this.else&&R(t,this.else.names),t}}b.kind="if";class v extends f{}v.kind="for";class w extends v{constructor(t){super(),this.iteration=t}render(t){return`for(${this.iteration})`+super.render(t)}optimizeNames(t,e){if(super.optimizeNames(t,e))return this.iteration=L(this.iteration,t,e),this}get names(){return R(super.names,this.iteration.names)}}class S extends v{constructor(t,e,a,n){super(),this.varKind=t,this.name=e,this.from=a,this.to=n}render(t){const e=t.es5?r.varKinds.var:this.varKind,{name:a,from:n,to:s}=this;return`for(${e} ${a}=${n}; ${a}<${s}; ${a}++)`+super.render(t)}get names(){const t=j(super.names,this.from);return j(t,this.to)}}class E extends v{constructor(t,e,a,n){super(),this.loop=t,this.varKind=e,this.name=a,this.iterable=n}render(t){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(t)}optimizeNames(t,e){if(super.optimizeNames(t,e))return this.iterable=L(this.iterable,t,e),this}get names(){return R(super.names,this.iterable.names)}}class T extends f{constructor(t,e,a){super(),this.name=t,this.args=e,this.async=a}render(t){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(t)}}T.kind="func";class k extends g{render(t){return"return "+super.render(t)}}k.kind="return";class C extends f{render(t){let e="try"+super.render(t);return this.catch&&(e+=this.catch.render(t)),this.finally&&(e+=this.finally.render(t)),e}optimizeNodes(){var t,e;return super.optimizeNodes(),null===(t=this.catch)||void 0===t||t.optimizeNodes(),null===(e=this.finally)||void 0===e||e.optimizeNodes(),this}optimizeNames(t,e){var a,n;return super.optimizeNames(t,e),null===(a=this.catch)||void 0===a||a.optimizeNames(t,e),null===(n=this.finally)||void 0===n||n.optimizeNames(t,e),this}get names(){const t=super.names;return this.catch&&R(t,this.catch.names),this.finally&&R(t,this.finally.names),t}}class x extends f{constructor(t){super(),this.error=t}render(t){return`catch(${this.error})`+super.render(t)}}x.kind="catch";class N extends f{render(t){return"finally"+super.render(t)}}function R(t,e){for(const a in e)t[a]=(t[a]||0)+(e[a]||0);return t}function j(t,e){return e instanceof n._CodeOrName?R(t,e.names):t}function L(t,e,a){return t instanceof n.Name?s(t):(r=t)instanceof n._Code&&r._items.some((t=>t instanceof n.Name&&1===e[t.str]&&void 0!==a[t.str]))?new n._Code(t._items.reduce(((t,e)=>(e instanceof n.Name&&(e=s(e)),e instanceof n._Code?t.push(...e._items):t.push(e),t)),[])):t;var r;function s(t){const n=a[t.str];return void 0===n||1!==e[t.str]?t:(delete e[t.str],n)}}function P(t,e){for(const a in e)t[a]=(t[a]||0)-(e[a]||0)}function $(t){return"boolean"==typeof t||"number"==typeof t||null===t?!t:n._`!${O(t)}`}N.kind="finally",e.CodeGen=class{constructor(t,e={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...e,_n:e.lines?"\n":""},this._extScope=t,this._scope=new r.Scope({parent:t}),this._nodes=[new _]}toString(){return this._root.render(this.opts)}name(t){return this._scope.name(t)}scopeName(t){return this._extScope.name(t)}scopeValue(t,e){const a=this._extScope.value(t,e);return(this._values[a.prefix]||(this._values[a.prefix]=new Set)).add(a),a}getScopeValue(t,e){return this._extScope.getValue(t,e)}scopeRefs(t){return this._extScope.scopeRefs(t,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(t,e,a,n){const r=this._scope.toName(e);return void 0!==a&&n&&(this._constants[r.str]=a),this._leafNode(new l(t,r,a)),r}const(t,e,a){return this._def(r.varKinds.const,t,e,a)}let(t,e,a){return this._def(r.varKinds.let,t,e,a)}var(t,e,a){return this._def(r.varKinds.var,t,e,a)}assign(t,e,a){return this._leafNode(new c(t,e,a))}add(t,a){return this._leafNode(new d(t,e.operators.ADD,a))}code(t){return"function"==typeof t?t():t!==n.nil&&this._leafNode(new m(t)),this}object(...t){const e=["{"];for(const[a,r]of t)e.length>1&&e.push(","),e.push(a),(a!==r||this.opts.es5)&&(e.push(":"),n.addCodeArg(e,r));return e.push("}"),new n._Code(e)}if(t,e,a){if(this._blockNode(new b(t)),e&&a)this.code(e).else().code(a).endIf();else if(e)this.code(e).endIf();else if(a)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(t){return this._elseNode(new b(t))}else(){return this._elseNode(new y)}endIf(){return this._endBlockNode(b,y)}_for(t,e){return this._blockNode(t),e&&this.code(e).endFor(),this}for(t,e){return this._for(new w(t),e)}forRange(t,e,a,n,s=(this.opts.es5?r.varKinds.var:r.varKinds.let)){const o=this._scope.toName(t);return this._for(new S(s,o,e,a),(()=>n(o)))}forOf(t,e,a,s=r.varKinds.const){const o=this._scope.toName(t);if(this.opts.es5){const t=e instanceof n.Name?e:this.var("_arr",e);return this.forRange("_i",0,n._`${t}.length`,(e=>{this.var(o,n._`${t}[${e}]`),a(o)}))}return this._for(new E("of",s,o,e),(()=>a(o)))}forIn(t,e,a,s=(this.opts.es5?r.varKinds.var:r.varKinds.const)){if(this.opts.ownProperties)return this.forOf(t,n._`Object.keys(${e})`,a);const o=this._scope.toName(t);return this._for(new E("in",s,o,e),(()=>a(o)))}endFor(){return this._endBlockNode(v)}label(t){return this._leafNode(new u(t))}break(t){return this._leafNode(new p(t))}return(t){const e=new k;if(this._blockNode(e),this.code(t),1!==e.nodes.length)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(k)}try(t,e,a){if(!e&&!a)throw new Error('CodeGen: "try" without "catch" and "finally"');const n=new C;if(this._blockNode(n),this.code(t),e){const t=this.name("e");this._currNode=n.catch=new x(t),e(t)}return a&&(this._currNode=n.finally=new N,this.code(a)),this._endBlockNode(x,N)}throw(t){return this._leafNode(new h(t))}block(t,e){return this._blockStarts.push(this._nodes.length),t&&this.code(t).endBlock(e),this}endBlock(t){const e=this._blockStarts.pop();if(void 0===e)throw new Error("CodeGen: not in self-balancing block");const a=this._nodes.length-e;if(a<0||void 0!==t&&a!==t)throw new Error(`CodeGen: wrong number of nodes: ${a} vs ${t} expected`);return this._nodes.length=e,this}func(t,e=n.nil,a,r){return this._blockNode(new T(t,e,a)),r&&this.code(r).endFunc(),this}endFunc(){return this._endBlockNode(T)}optimize(t=1){for(;t-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(t){return this._currNode.nodes.push(t),this}_blockNode(t){this._currNode.nodes.push(t),this._nodes.push(t)}_endBlockNode(t,e){const a=this._currNode;if(a instanceof t||e&&a instanceof e)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${e?`${t.kind}/${e.kind}`:t.kind}"`)}_elseNode(t){const e=this._currNode;if(!(e instanceof b))throw new Error('CodeGen: "else" without "if"');return this._currNode=e.else=t,this}get _root(){return this._nodes[0]}get _currNode(){const t=this._nodes;return t[t.length-1]}set _currNode(t){const e=this._nodes;e[e.length-1]=t}},e.not=$;const A=I(e.operators.AND);e.and=function(...t){return t.reduce(A)};const D=I(e.operators.OR);function I(t){return(e,a)=>e===n.nil?a:a===n.nil?e:n._`${O(e)} ${t} ${O(a)}`}function O(t){return t instanceof n.Name?t:n._`(${t})`}e.or=function(...t){return t.reduce(D)}},845:(t,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ValueScope=e.ValueScopeName=e.Scope=e.varKinds=e.UsedValueState=void 0;const n=a(520);class r extends Error{constructor(t){super(`CodeGen: "code" for ${t} not defined`),this.value=t.value}}var s;!function(t){t[t.Started=0]="Started",t[t.Completed=1]="Completed"}(s=e.UsedValueState||(e.UsedValueState={})),e.varKinds={const:new n.Name("const"),let:new n.Name("let"),var:new n.Name("var")};class o{constructor({prefixes:t,parent:e}={}){this._names={},this._prefixes=t,this._parent=e}toName(t){return t instanceof n.Name?t:this.name(t)}name(t){return new n.Name(this._newName(t))}_newName(t){return`${t}${(this._names[t]||this._nameGroup(t)).index++}`}_nameGroup(t){var e,a;if((null===(a=null===(e=this._parent)||void 0===e?void 0:e._prefixes)||void 0===a?void 0:a.has(t))||this._prefixes&&!this._prefixes.has(t))throw new Error(`CodeGen: prefix "${t}" is not allowed in this scope`);return this._names[t]={prefix:t,index:0}}}e.Scope=o;class i extends n.Name{constructor(t,e){super(e),this.prefix=t}setValue(t,{property:e,itemIndex:a}){this.value=t,this.scopePath=n._`.${new n.Name(e)}[${a}]`}}e.ValueScopeName=i;const l=n._`\n`;e.ValueScope=class extends o{constructor(t){super(t),this._values={},this._scope=t.scope,this.opts={...t,_n:t.lines?l:n.nil}}get(){return this._scope}name(t){return new i(t,this._newName(t))}value(t,e){var a;if(void 0===e.ref)throw new Error("CodeGen: ref must be passed in value");const n=this.toName(t),{prefix:r}=n,s=null!==(a=e.key)&&void 0!==a?a:e.ref;let o=this._values[r];if(o){const t=o.get(s);if(t)return t}else o=this._values[r]=new Map;o.set(s,n);const i=this._scope[r]||(this._scope[r]=[]),l=i.length;return i[l]=e.ref,n.setValue(e,{property:r,itemIndex:l}),n}getValue(t,e){const a=this._values[t];if(a)return a.get(e)}scopeRefs(t,e=this._values){return this._reduceValues(e,(e=>{if(void 0===e.scopePath)throw new Error(`CodeGen: name "${e}" has no value`);return n._`${t}${e.scopePath}`}))}scopeCode(t=this._values,e,a){return this._reduceValues(t,(t=>{if(void 0===t.value)throw new Error(`CodeGen: name "${t}" has no value`);return t.value.code}),e,a)}_reduceValues(t,a,o={},i){let l=n.nil;for(const c in t){const d=t[c];if(!d)continue;const u=o[c]=o[c]||new Map;d.forEach((t=>{if(u.has(t))return;u.set(t,s.Started);let o=a(t);if(o){const a=this.opts.es5?e.varKinds.var:e.varKinds.const;l=n._`${l}${a} ${t} = ${o};${this.opts._n}`}else{if(!(o=null==i?void 0:i(t)))throw new r(t);l=n._`${l}${o}${this.opts._n}`}u.set(t,s.Completed)}))}return l}}},708:(t,e,a)=>{e.yf=void 0;const n=a(29);a(23);e.yf={message:({keyword:t})=>n.str`should pass "${t}" keyword validation`};new n.Name("keyword"),new n.Name("schemaPath"),new n.Name("params"),new n.Name("propertyName"),new n.Name("message"),new n.Name("schema"),new n.Name("parentSchema"),new n.Name("instancePath")},23:(t,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0});const n=a(29),r={data:new n.Name("data"),valCxt:new n.Name("valCxt"),dataPath:new n.Name("dataPath"),parentData:new n.Name("parentData"),parentDataProperty:new n.Name("parentDataProperty"),rootData:new n.Name("rootData"),dynamicAnchors:new n.Name("dynamicAnchors"),vErrors:new n.Name("vErrors"),errors:new n.Name("errors"),this:new n.Name("this"),self:new n.Name("self"),scope:new n.Name("scope"),json:new n.Name("json"),jsonPos:new n.Name("jsonPos"),jsonLen:new n.Name("jsonLen"),jsonPart:new n.Name("jsonPart")};e.default=r},338:(t,e,a)=>{var n=a(795);e.createRoot=n.createRoot,e.hydrateRoot=n.hydrateRoot},795:t=>{t.exports=window.ReactDOM}},e={};function a(n){var r=e[n];if(void 0!==r)return r.exports;var s=e[n]={exports:{}};return t[n](s,s.exports,a),s.exports}a.d=(t,e)=>{for(var n in e)a.o(e,n)&&!a.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},a.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),a.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};a.r(n),a.d(n,{contentSaveSource:()=>X,contentSaveTranslate:()=>Z,excerptSaveSource:()=>Y,excerptSaveTranslate:()=>J,metaFieldsSaveSource:()=>tt,metaFieldsSaveTranslate:()=>et,setBlockRules:()=>at,titleSaveSource:()=>G,titleSaveTranslate:()=>U,translationInfo:()=>nt});var r={};a.r(r),a.d(r,{getBlockRules:()=>st,getTranslatedString:()=>ot,getTranslationEntry:()=>rt,getTranslationInfo:()=>it});var s=a(338);const o=window.wp.element,i=window.wp.data,{__}=wp.i18n,l=t=>React.createElement("div",{className:"modal-header",key:t.modalRender},React.createElement("span",{className:"close",onClick:()=>{t.setPopupVisibility(!1)}},"×"),React.createElement("h2",{className:"notranslate"},__("Step 2 - Start Automatic Translation Process","automatic-translations-for-polylang")),React.createElement("div",{className:"save_btn_cont"},React.createElement("button",{className:"notranslate save_it button button-primary",disabled:t.translatePendingStatus,onClick:t.updatePostData},__("Update Content","automatic-translations-for-polylang"))),!t.translatePendingStatus&&React.createElement("div",{className:"atfp-character-count-container"},React.createElement("p",null,"Wahooo! You have saved your valuable time via auto translating ",React.createElement("strong",null,t.characterCount)," characters using ",React.createElement("strong",null,(()=>{const e=t.service;return"yandex"===e?"Yandex Translate":"google"===e?"Google Translate":"local-ai-translator"===e?"Local AI Translator":e})()),"."))),c=window.React,d=t=>{const e=t=>{const a=document.createElement("div");a.innerHTML=t;const n=a.firstElementChild;if(!n)return t;let r=n.children;const s=r.length;if(s>0)for(let t=0;t<s;t++){let a=r[t],n=e(a.outerHTML);a.outerHTML=n}const o=n.outerHTML.match(/^<[^>]+>/)[0],i=n.tagName.toLowerCase(),l=new RegExp(`</${i}>`,"i"),c=n.outerHTML.match(l);if("<style>"===o)return`#atfp_open_translate_span#${n.outerHTML}#atfp_close_translate_span#`;const d=n.innerHTML;n.innerHTML="";let u=`#atfp_open_translate_span#${o}#atfp_close_translate_span#`,p="",h="";return c&&(p=`#atfp_open_translate_span#</${i}>#atfp_close_translate_span#`),""!==d?(""!==u&&(h=u+d),""!==p&&(h+=p)):h=u+p,n.outerHTML=h,a.innerHTML},a="yandex"===t.service||"localAiTranslator"===t.service?(a=>{const n=document.createElement("div");n.innerHTML=a,function(t){let a=t.children;const n=()=>{if(a.length>0){let t=a[0],r=e(t.outerHTML);const s=document.createTextNode(r);t.replaceWith(s),n()}};n()}(n);let r=n.innerText;return/^(_yoast_wpseo_|rank_math_|_seopress_)/.test(t.contentKey.trim())&&(r=(t=>t.replace(/(%{1,2}[a-zA-Z0-9_]+%{0,2})/g,(t=>`#atfp_open_translate_span#${t}#atfp_close_translate_span#`)))(r)),(t=>t.split(/(#atfp_open_translate_span#.*?#atfp_close_translate_span#)|'/).filter(Boolean).filter((t=>""!==t.trim())))(r)})(t.content):t.content,n=/#atfp_open_translate_span#[\s\S]*?#atfp_close_translate_span#/,r=/#atfp_open_translate_span#|#atfp_close_translate_span#/g;return React.createElement(React.Fragment,null,"yandex"===t.service||"localAiTranslator"===t.service?a.map(((t,e)=>n.test(t)?React.createElement("span",{key:e,className:"notranslate atfp-notraslate-tag",translate:"no"},(t=>t.replace(r,""))(t)):t)):a)},u={_yoast_wpseo_title:{type:"string"},_yoast_wpseo_focuskw:{type:"string"},_yoast_wpseo_metadesc:{type:"string"},_yoast_wpseo_bctitle:{type:"string"},"_yoast_wpseo_opengraph-title":{type:"string"},"_yoast_wpseo_opengraph-description":{type:"string"},"_yoast_wpseo_twitter-title":{type:"string"},"_yoast_wpseo_twitter-description":{type:"string"},rank_math_title:{type:"string"},rank_math_description:{type:"string"},rank_math_focus_keyword:{type:"string"},rank_math_facebook_title:{type:"string"},rank_math_facebook_description:{type:"string"},rank_math_twitter_title:{type:"string"},rank_math_twitter_description:{type:"string"},rank_math_breadcrumb_title:{type:"string"},_seopress_titles_title:{type:"string"},_seopress_titles_desc:{type:"string"},_seopress_social_fb_title:{type:"string"},_seopress_social_fb_desc:{type:"string"},_seopress_social_twitter_title:{type:"string"},_seopress_social_twitter_desc:{type:"string"},_seopress_analysis_target_kw:{type:"string"}},p=({type:t,key:e,translateContent:a,source:n,provider:r})=>{if(["title","excerpt"].includes(t)){const e=`${t}SaveTranslate`;(0,i.dispatch)("block-atfp/translate")[e](a,r)}else["metaFields"].includes(t)?Object.keys(u).includes(e)&&(0,i.dispatch)("block-atfp/translate").metaFieldsSaveTranslate(e,a,n,r):(0,i.dispatch)("block-atfp/translate").contentSaveTranslate(e,a,n,r)},h=({prefix:t=!1,start:e=!1,end:a=!1,translateStatus:n=!1})=>{const r=(a-e)/1e3,s={};if(t){if(s.provider=t,e&&a){const e=(0,i.select)("block-atfp/translate").getTranslationInfo().translateData[t]?.timeTaken||0;s.timeTaken=r+e}n&&(s.translateStatus=!0),(0,i.dispatch)("block-atfp/translate").translationInfo(s)}};a(708);const m=({container:t,provider:e})=>{t.querySelector(".atfp_translate_progress").style.display="none",t.querySelector(".atfp_string_container").style.animation="none",document.body.style.top="0";const a=t.querySelector("button.save_it");a.removeAttribute("disabled"),a.classList.add("translated"),a.classList.remove("notranslate"),(t=>{const e=document.getElementById("atfp_strings_model").querySelector(".atfp_string_container").querySelectorAll("td.translate[data-string-type]"),a=e.length;e.forEach(((e,n)=>{const r=e.innerText,s=e.dataset.key,o=e.dataset.stringType,l=e.closest("tr").querySelector('td[data-source="source_text"]').innerText;p({type:o,key:s,translateContent:r,source:l,provider:"yandex"});const c=(0,i.select)("block-atfp/translate").getTranslationInfo().translateData?.yandex,d=c&&c.targetWordCount?c.targetWordCount:0,u=c&&c.targetCharacterCount?c.targetCharacterCount:0;""!==r.trim()&&r.trim().length>0&&(0,i.dispatch)("block-atfp/translate").translationInfo({targetWordCount:d+l.trim().split(/\s+/).filter((t=>/[^\p{L}\p{N}]/.test(t))).length,targetCharacterCount:u+l.trim().length,provider:"yandex"}),n===a-1&&(jQuery(`.${t}-translator_progress`).css("width","100%"),jQuery(`.${t}-translator-strings-count`).show())}))})(e)},g=(t,e)=>{const a=(new Date).getTime();let n=!1;(t=>{const e=(0,i.select)("block-atfp/translate").getTranslationInfo().sourceCharacterCount;if(document.querySelector(`#atfp-${t}-strings-modal .${t}-translator_progress_bar`))jQuery(`.${t}-translator_progress`).css("width","0%"),jQuery(`.${t}-translator-strings-count`).hide();else{const a=jQuery(`\n            <div class="${t}-translator_progress_bar" style="background-color: #f3f3f3;border-radius: 10px;overflow: hidden;margin: 1.5rem auto; width: 50%;">\n            <div class="${t}-translator_progress" style="overflow: hidden;transition: width .2s ease-in-out; border-radius: 10px;text-align: center;width: 0%;height: 20px;box-sizing: border-box;background-color: #4caf50; color: #fff; font-weight: 600;"></div>\n            </div>\n            <div style="display:none; color: white;" class="${t}-translator-strings-count hidden">\n                Wahooo! You have saved your valuable time via auto translating \n                <strong class="totalChars">${e}</strong> characters using \n                <strong>\n                    ${t} Translator\n                </strong>\n            </div>\n        `);jQuery("#atfp_strings_model .atfp_translate_progress").append(a)}})(e);const r=document.getElementById("atfp_strings_model"),s=r.querySelector(".atfp_string_container");s.scrollTop=0;const o=s.scrollHeight;void 0!==o&&o>100?(document.querySelector(".atfp_translate_progress").style.display="block",setTimeout((()=>{const t=2e3*Math.ceil(o/s?.offsetHeight);(t=>{const{element:e,scrollSpeed:a,provider:n}=t;if(e.scrollHeight-e.offsetHeight<=0)return;const r=e.scrollHeight-e.offsetHeight+100,s=jQuery(`.${n}-translator_progress_bar`);let o=null,i=e.scrollTop;const l=()=>{const t=performance.now();o||(o=t);const c=i+(t-o)/a*(r+2e3-i);var d=e.scrollTop/(e.scrollHeight-e.clientHeight)*100;s.find(`.${n}-translator_progress`).css("width",d+"%");let u=(Math.round(10*d)/10).toFixed(1);u=Math.min(u,100).toString(),s.find(`.${n}-translator_progress`).text(u+"%"),c>r?jQuery(`.${n}-translator-strings-count`).show():(e.scrollTop=c,c<r&&setTimeout(l,16))};l()})({element:s,scrollSpeed:t,provider:e})}),2e3),s.addEventListener("scroll",(()=>{s.scrollTop+s.clientHeight+50>=s.scrollHeight&&!n&&(h({prefix:"yandex",start:a,end:(new Date).getTime(),translateStatus:!0}),setTimeout((()=>{m({container:r,provider:e}),t()}),4e3),n=!0)})),s.clientHeight+10>=o&&(h({prefix:"yandex",start:a,end:(new Date).getTime(),translateStatus:!0}),jQuery(`.${e}-translator_progress`).css("width","100%"),jQuery(`.${e}-translator_progress`).text("100%"),jQuery(`.${e}-translator-strings-count`).show(),setTimeout((()=>{m({container:r,provider:e}),t()}),4e3))):(h({prefix:"yandex",start:a,end:(new Date).getTime(),translateStatus:!0}),jQuery(`.${e}-translator_progress`).css("width","100%"),jQuery(`.${e}-translator_progress`).text("100%"),jQuery(`.${e}-translator-strings-count`).show(),setTimeout((()=>{m({container:r,provider:e}),t()}),4e3))},f=(t,e,a,n,r,s,o)=>{var i={keycode:{ESCAPE:27},getRequest:function(){return t.XDomainRequest?new t.XDomainRequest:t.XMLHttpRequest?new t.XMLHttpRequest:null},loadScript:function(t,a,n){var r=e.createElement("script");r.src=t,r.addEventListener("load",(function t(){this.removeEventListener("load",t,!1),n()}),!1),a.appendChild(r)},loadResource:function(e,a){var n=this.getRequest();return n?(n.onload=function(){a(this.responseText)},n.open("GET",e,!0),t.setTimeout((function(){n.send()}),0),n):null},getStyleList:function(t){var e=t.getAttribute("class");return e?e.replace(/\s+/g," ").trim().split(" "):[]},hasStyleName:function(t,e){var a=this.getStyleList(t);return!!a.length&&a.indexOf(e)>=0},addStyleName:function(t,e){var a=this.getStyleList(t);a.push(e),t.setAttribute("class",a.join(" "))},removeStyleName:function(t,e){var a=this.getStyleList(t),n=a.indexOf(e);n>=0&&(a.splice(n,1),t.setAttribute("class",a.join(" ")))},isSupportedBrowser:function(){return"localStorage"in t&&"querySelector"in e&&"addEventListener"in t&&"getComputedStyle"in t&&"CSS1Compat"===e.compatMode}},l=function(t,e){var a=this;t.addEventListener("click",(function(t){a.onClick(t)}),!1),this._element=t,this._contentElement=e||this._element};l.prototype.onClick=function(){},l.prototype.setText=function(t){return this._contentElement.textContent=t,this};var c=function(t,e){var a=this;t.reset(),t.addEventListener("click",(function(t){var e=t.target;"value"in e&&a.onSelect(e.value)}),!1),t.addEventListener("change",(function(t){alert("form change state");var e=t.target;e.checked&&a.onChange(e.value)}),!1),this._form=t,this._itemName=e};c.prototype.onSelect=function(){},c.prototype.onChange=function(){},c.prototype.isHidden=function(){return this._form.hasAttribute("hidden")},c.prototype.getItems=function(){return this._form[this._itemName]||[]},c.prototype.getValue=function(){var t,e,a=this.getItems();for(t=0,e=a.length;t<e;t++)if(a[t].checked)return a[t].value;return""},c.prototype.setValue=function(t){var e,a,n=this.getItems();if(t===this.getValue())return this;for(e=0,a=n.length;e<a;e++)if(n[e].value===t){n[e].checked=!0,this.onChange(t);break}return this},c.prototype.setHidden=function(t){return(t=!!t)!==this.isHidden()&&(this._form[(t?"set":"remove")+"Attribute"]("hidden",""),this.onHiddenChange(t)),this},c.prototype.onHiddenChange=function(){};var d=function(a){var n,r=this,l=a.select,c=a.element,d=a.storage,u=(a.autoMode,a.pageLang),p=(a.userLang,a.translator),h=a.leftButton,m=a.rightButton,f=a.closeButton;if(this._element=c,this._pageLang=u,this._translator=p,this.onStateChange=function(t,e){"active"===t&&d.setValue("active",e)},l.onSelect=function(t){this.setHidden(!0),r.translate(t),g(o,"yandex")},l.onChange=function(t){d.setValue("lang",t),m.setText(t),r.setState("invalid",t===u)},l.onHiddenChange=function(a){var n,s=e.documentElement;r.setState("expanded",!a),a||(r.setState("right",!1).setState("bottom",!1),c.focus(),(n=this._form.getBoundingClientRect()).right+(t.pageXOffset||s.scrollLeft)+1>=Math.max(s.clientWidth,s.scrollWidth)&&r.setState("right",!0),n.bottom+(t.pageYOffset||s.scrollTop)+1>=Math.max(s.clientHeight,s.scrollHeight)&&r.setState("bottom",!0))},c.addEventListener("blur",(function(){l.setHidden(!0)}),!1),c.addEventListener("keydown",(function(t){t.keyCode===i.keycode.ESCAPE&&l.setHidden(!0)}),!1),p.on("error",(function(){this.abort(),r.setState("busy",!1).setState("error",!0)})),p.on("progress",(function(t){switch(t){case 0:r.setState("busy",!0).setState("active",!0);break;case 100:r.setState("done",!0).setState("busy",!1)}})),h.onClick=function(){l.setHidden(!0),r.translate(l.getValue()),g(o,"yandex")},m.onClick=function(){r.hasState("active")?(p.undo(),r.setState("busy",!1).setState("done",!1).setState("error",!1).setState("active",!1)):l.setHidden(!l.isHidden())},f.onClick=function(){l.setHidden(!0)},null!=s)var _=s;switch(_){case"nb":case"nn":n="no";break;default:n=_}n&&(l.setValue(n),d.getValue("active"))};d.prototype.hasState=function(t){return i.hasStyleName(this._element,"yt-state_"+t)},d.prototype.setState=function(t,e){return(e=!!e)===this.hasState(t)||(i[(e?"add":"remove")+"StyleName"](this._element,"yt-state_"+t),this.onStateChange(t,e)),this},d.prototype.translate=function(t){return t&&!this.hasState("active")&&this._translator.translate(this._pageLang,t),this},d.prototype.onStateChange=function(){};var u=function(e){this._name=e;try{this._data=t.JSON.parse(t.localStorage[e])}catch(t){this._data={}}};u.prototype.getValue=function(t){return this._data[t]},u.prototype.setValue=function(e,a){this._data[e]=a;try{t.localStorage[this._name]=t.JSON.stringify(this._data)}catch(t){}};var p=e.getElementById(n.widgetId);if(p&&i.isSupportedBrowser()){var h=function(){i.loadScript("https://yastatic.net/s3/translate/v21.4.7/js/tr_page.js",p,(function(){i.loadResource("https://translate.yandex.net/website-widget/v1/widget.html",(function(t){var e;t&&(p.innerHTML=t,e=p.querySelector(".yt-widget"),n.widgetTheme&&e.setAttribute("data-theme",n.widgetTheme),new d({select:new c(e.querySelector(".yt-listbox"),"yt-lang"),element:e,storage:new u("yt-widget"),autoMode:"true"===n.autoMode,pageLang:n.pageLang,userLang:(a.language||a.userLanguage||"").split("-")[0],translator:new r.PageTranslator({srv:"tr-url-widget",url:"https://translate.yandex.net/api/v1/tr.json/translate",autoSync:!0,maxPortionLength:600}),leftButton:new l(e.querySelector(".yt-button_type_left")),rightButton:new l(e.querySelector(".yt-button_type_right"),e.querySelector(".yt-button_type_right > .yt-button__text")),closeButton:new l(e.querySelector(".yt-button_type_close"))}))}))}))};"complete"===e.readyState||"interactive"===e.readyState?h():e.addEventListener("DOMContentLoaded",h,!1)}};class _{static Object=t=>new this(t).extraData();constructor(t){this.btnSelector=t.btnSelector||!1,this.btnClass=t.btnClass||!1,this.btnText=t.btnText||`Translate To ${t.targetLanguageLabel} (Beta)`,this.stringSelector=t.stringSelector||!1,this.progressBarSelector=t.progressBarSelector||!1,this.onStartTranslationProcess=t.onStartTranslationProcess||(()=>{}),this.onComplete=t.onComplete||(()=>{}),this.onLanguageError=t.onLanguageError||(()=>{}),this.onBeforeTranslate=t.onBeforeTranslate||(()=>{}),this.onAfterTranslate=t.onAfterTranslate||(()=>{}),this.sourceLanguage=t.sourceLanguage||"en",this.targetLanguage=t.targetLanguage||"hi",this.targetLanguageLabel=t.targetLanguageLabel||"Hindi"}extraData=async()=>{const t=await _.languageSupportedStatus(this.sourceLanguage,this.targetLanguage,this.targetLanguageLabel);return!0!==t?(this.onLanguageError(t),{}):(this.defaultLang=this.targetLanguage,{continueTranslation:this.continueTranslation,stopTranslation:this.stopTranslation,startTranslation:this.startTranslation,reInit:this.reInit,init:this.init})};static languageSupportedStatus=async(t,e,a)=>{const n=["en","es","ja","ar","bn","de","fr","hi","it","ko","nl","pl","pt","ru","th","tr","vi","zh","zh-hant","bg","cs","da","el","fi","hr","hu","id","iw","lt","no","ro","sk","sl","sv","uk","en-zh"].map((t=>t.toLowerCase()));if(!window.hasOwnProperty("chrome")||!navigator.userAgent.includes("Chrome")||navigator.userAgent.includes("Edg"))return jQuery('<span style="color: #ff4646; margin-top: .5rem; display: inline-block;">The Translator API, which uses local AI models, only works in the Chrome browser. For more details, <a href="https://developer.chrome.com/docs/ai/translator-api" target="_blank">click here</a>.</span>');if(!("translation"in self)||!("createTranslator"in self.translation))return jQuery('<span style="color: #ff4646; margin-top: .5rem; display: inline-block;">The Translator AI modal is currently not supported or disabled in your browser. Please enable it. For detailed instructions on how to enable the Translator AI modal in your Chrome browser, <a href="https://developer.chrome.com/docs/ai/translator-api#bypass_language_restrictions_for_local_testing" target="_blank">click here</a>.</span>');if(!n.includes(e.toLowerCase()))return jQuery(`<span style="color: #ff4646; margin-top: .5rem; display: inline-block;">Unfortunately, the <strong>${a} (${e})</strong> language is currently not supported by the Local Translator AI modal. Please check and read the docs which languages are currently supported by <a href="https://developer.chrome.com/docs/ai/translator-api#bypass_language_restrictions_for_local_testing" target="_blank">clicking here</a>.</span>`);const r=await translation.canTranslate({sourceLanguage:t,targetLanguage:e});return"after-download"===r?jQuery(`<span style="color: #ff4646; margin-top: .5rem; display: inline-block;">Please install the <strong>${a} (${e})</strong> language pack to proceed.To install the language pack, visit <strong>chrome://on-device-translation-internals</strong>. For further assistance, refer to the <a href="https://developer.chrome.com/docs/ai/translator-api#bypass_language_restrictions_for_local_testing" target="_blank">documentation</a>.</span>`):"readily"===r||jQuery(`<span style="color: #ff4646; margin-top: .5rem; display: inline-block;">Please ensure that the <strong>${a} (${e})</strong> language pack is installed and set as a preferred language in your browser. To install the language pack, visit <strong>chrome://on-device-translation-internals</strong>. For further assistance, refer to the <a href="https://developer.chrome.com/docs/ai/translator-api#bypass_language_restrictions_for_local_testing" target="_blank">documentation</a>.</span>`)};init=async()=>{this.appendBtn(),this.translationStart=!1,this.completedTranslateIndex=0,this.completedCharacterCount=0,this.translateBtnEvents(),this.progressBarSelector&&this.addProgressBar()};appendBtn=()=>{this.translateBtn=jQuery(`<button class="button button-primary${this.btnClass?" "+this.btnClass:""}">${this.btnText}</button>`),jQuery(this.btnSelector).append(this.translateBtn)};translateBtnEvents=t=>this.btnSelector&&0!==jQuery(this.btnSelector).length?this.stringSelector&&0!==jQuery(this.stringSelector).length?(this.translateStatus=!0,this.translateBtn.off("click"),this.translateBtn.prop("disabled",!1),void(this.translationStart?this.translateStringEle.length>this.completedTranslateIndex+1?this.translateBtn.on("click",(()=>{this.onStartTranslationProcess(),this.stringTranslation(this.completedTranslateIndex+1)})):(this.onComplete({translatedStringsCount:this.completedCharacterCount}),this.translateBtn.prop("disabled",!0)):this.translateBtn.on("click",this.startTranslationProcess))):this.onLanguageError("The string selector is missing. Please provide a valid selector for the strings to be translated."):this.onLanguageError("The button selector is missing. Please provide a valid selector for the button.");startTranslationProcess=async()=>{this.onStartTranslationProcess();const t=this.defaultLang;this.translationStart=!0,this.translateStringEle=jQuery(this.stringSelector),this.totalStringCount=Array.from(this.translateStringEle).map((t=>t.innerText.length)).reduce(((t,e)=>t+e),0),this.translator=await self.translation.createTranslator({sourceLanguage:this.sourceLanguage,targetLanguage:t}),this.translateStringEle.length>0&&await this.stringTranslation(this.completedTranslateIndex)};stringTranslation=async t=>{if(!this.translateStatus)return;const e=this.translateStringEle[t];this.onBeforeTranslate(e);const a=e.innerText;let n=[];(e.childNodes.length>0&&!e.querySelector(".notranslate")||e.querySelector(".notranslate"))&&e.childNodes.forEach((t=>{3===t.nodeType&&""!==t.nodeValue.trim()&&n.push(t)})),n.length>0&&await this.stringTranslationBatch(n,0),this.completedCharacterCount+=a.length,this.completedTranslateIndex=t,this.progressBarSelector&&this.updateProgressBar(),this.onAfterTranslate(e),this.translateStringEle.length>t+1&&await this.stringTranslation(this.completedTranslateIndex+1),t===this.translateStringEle.length-1&&(this.translateBtn.prop("disabled",!0),this.onComplete({characterCount:this.completedCharacterCount}),jQuery(this.progressBarSelector).find(".chrome-ai-translator-strings-count").show().find(".totalChars").text(this.completedCharacterCount))};stringTranslationBatch=async(t,e)=>{const a=await this.translator.translate(t[e].nodeValue);return a&&""!==a&&(t[e].nodeValue=a),e<t.length-1&&await this.stringTranslationBatch(t,e+1),!0};addProgressBar=()=>{if(!document.querySelector("#chrome-ai-translator-modal .chrome-ai-translator_progress_bar")){const t=jQuery('\n                <div class="chrome-ai-translator_progress_bar" style="background-color: #f3f3f3;border-radius: 10px;overflow: hidden;margin: 1.5rem auto; width: 50%;">\n                <div class="chrome-ai-translator_progress" style="overflow: hidden;transition: width .5s ease-in-out; border-radius: 10px;text-align: center;width: 0%;height: 20px;box-sizing: border-box;background-color: #4caf50; color: #fff; font-weight: 600;"></div>\n                </div>\n                <div style="display:none; color: white;" class="chrome-ai-translator-strings-count hidden">\n                    Wahooo! You have saved your valuable time via auto translating \n                    <strong class="totalChars">0</strong> characters using \n                    <strong>\n                        Chrome AI Translator\n                    </strong>\n                </div>\n            ');jQuery(this.progressBarSelector).append(t)}};updateProgressBar=()=>{const t=this.completedCharacterCount/this.totalStringCount*1e3/10;let e=t.toString().split(".")[1]||"";e=e.length>0&&"0"!==e[0]?e[0]:"";const a=parseInt(t)+""+(""!==e?"."+e:"");jQuery(".chrome-ai-translator_progress").css({width:`${a}%`}).text(`${a}%`)};stopTranslation=()=>{this.translateStatus=!1};reInit=()=>{this.translateBtnEvents()};startTranslation=()=>{this.translateStatus=!0,this.startTranslationProcess(this.completedTranslateIndex+1)}}const y=_,b=window.wp.i18n,v={yandex:t=>{const e=window;f(e,e.document,e.navigator,{pageLang:t.sourceLang,autoMode:"false",widgetId:"atfp_yandex_translate_element",widgetTheme:"light"},e.yt=e.yt||{},t.targetLang,t.translateStatus)},localAiTranslator:async t=>{const e=atfp_global_object.languageObject[t.targetLang];let a=!1,n=0;const r=await y.Object({mainWrapperSelector:"#atfp_strings_model",btnSelector:`#${t.ID}`,btnClass:"local_ai_translator_btn",btnText:(0,b.__)("Translate To","automatic-translations-for-polylang")+" "+e+" (Beta)",stringSelector:".atfp_string_container tbody tr td.translate:not([data-translate-status='translated'])",progressBarSelector:"#atfp_strings_model .atfp_translate_progress",sourceLanguage:t.sourceLang,targetLanguage:t.targetLang,targetLanguageLabel:e,onStartTranslationProcess:()=>{n=(new Date).getTime(),jQuery("#atfp_strings_model .modal-content .atfp_string_container")[0].scrollHeight>100&&jQuery("#atfp_strings_model .atfp_translate_progress").fadeIn("slow")},onComplete:()=>{h({prefix:"localAiTranslator",start:n,end:(new Date).getTime(),translateStatus:!0}),setTimeout((()=>{t.translateStatus(),jQuery("#atfp_strings_model .atfp_translate_progress").fadeOut("slow")}),4e3)},onBeforeTranslate:t=>{const e=jQuery("#atfp_strings_model .modal-content .atfp_string_container");if(e.length<1)return r.stopTranslation(),h({prefix:"localAiTranslator",start:n,end:(new Date).getTime()}),void(n=0);const a=e[0].getBoundingClientRect(),s=t.closest("tr").offsetTop,o=e.height();var i;s>o+a.y&&(i=s-o+t.offsetHeight,e.scrollTop(i))},onAfterTranslate:t=>{const e=t.innerText,a=t.dataset.stringType,n=t.dataset.key,r=t.closest("tr").querySelector('td[data-source="source_text"]').innerText;p({type:a,key:n,translateContent:e,source:r,provider:"localAiTranslator"});const s=(0,i.select)("block-atfp/translate").getTranslationInfo().translateData?.localAiTranslator,o=s&&s.targetWordCount?s.targetWordCount:0,l=s&&s.targetCharacterCount?s.targetCharacterCount:0;""!==e.trim()&&e.trim().length>0&&(0,i.dispatch)("block-atfp/translate").translationInfo({targetWordCount:o+r.trim().split(/\s+/).filter((t=>/[^\p{L}\p{N}]/.test(t))).length,targetCharacterCount:l+r.trim().length,provider:"localAiTranslator"})}});r.hasOwnProperty("init")&&(!0,r.init())}},w=c.createContext({});function S({baseColor:t,highlightColor:e,width:a,height:n,borderRadius:r,circle:s,direction:o,duration:i,enableAnimation:l=!0,customHighlightBackground:c}){const d={};return"rtl"===o&&(d["--animation-direction"]="reverse"),"number"==typeof i&&(d["--animation-duration"]=`${i}s`),l||(d["--pseudo-element-display"]="none"),"string"!=typeof a&&"number"!=typeof a||(d.width=a),"string"!=typeof n&&"number"!=typeof n||(d.height=n),"string"!=typeof r&&"number"!=typeof r||(d.borderRadius=r),s&&(d.borderRadius="50%"),void 0!==t&&(d["--base-color"]=t),void 0!==e&&(d["--highlight-color"]=e),"string"==typeof c&&(d["--custom-highlight-background"]=c),d}function E({count:t=1,wrapper:e,className:a,containerClassName:n,containerTestId:r,circle:s=!1,style:o,...i}){var l,d,u;const p=c.useContext(w),h={...i};for(const[t,e]of Object.entries(i))void 0===e&&delete h[t];const m={...p,...h,circle:s},g={...o,...S(m)};let f="react-loading-skeleton";a&&(f+=` ${a}`);const _=null!==(l=m.inline)&&void 0!==l&&l,y=[],b=Math.ceil(t);for(let e=0;e<b;e++){let a=g;if(b>t&&e===b-1){const e=null!==(d=a.width)&&void 0!==d?d:"100%",n=t%1,r="number"==typeof e?e*n:`calc(${e} * ${n})`;a={...a,width:r}}const n=c.createElement("span",{className:f,style:a,key:e},"‌");_?y.push(n):y.push(c.createElement(c.Fragment,{key:e},n,c.createElement("br",null)))}return c.createElement("span",{className:n,"data-testid":r,"aria-live":"polite","aria-busy":null===(u=m.enableAnimation)||void 0===u||u},e?y.map(((t,a)=>c.createElement(e,{key:a},t))):y)}const{__:T}=wp.i18n,{select:k}=wp.data,{Fragment:C}=wp.element,x=t=>{const{service:e}=t,a=k("block-atfp/translate").getTranslationEntry();return(0,c.useEffect)((()=>{"yandex"===t.service&&(document.documentElement.setAttribute("translate","no"),document.body.classList.add("notranslate"));const e=t.service,a=`atfp_${e}_translate_element`;wp.data.select("block-atfp/translate").getTranslationEntry().length>0&&t.postDataFetchStatus&&v[e]({sourceLang:t.sourceLang,targetLang:t.targetLang,translateStatus:t.translateStatusHandler,ID:a})}),[t.modalRender,t.postDataFetchStatus]),React.createElement("div",{className:"modal-body"},a.length>0&&t.postDataFetchStatus?React.createElement(React.Fragment,null,React.createElement("div",{className:"atfp_translate_progress",key:t.modalRender},T("Automatic translation is in progress....","automatic-translations-for-polylang"),React.createElement("br",null),T("It will take few minutes, enjoy ☕ coffee in this time!","automatic-translations-for-polylang"),React.createElement("br",null),React.createElement("br",null),T("Please do not leave this window or browser tab while translation is in progress...","automatic-translations-for-polylang")),React.createElement("div",{className:`translator-widget ${e}`,style:{display:"localAiTranslator"===t.service?"flex":"block"}},"localAiTranslator"===t.service?React.createElement("h3",{className:"choose-lang"},T("Translate Using Chrome built-in API","automatic-translations-for-polylang")," ",React.createElement("span",{className:"dashicons-before dashicons-translation"})):React.createElement("h3",{className:"choose-lang"},T("Choose language","automatic-translations-for-polylang")," ",React.createElement("span",{className:"dashicons-before dashicons-translation"})),React.createElement("div",{className:"atfp_translate_element_wrapper "+(t.translateStatus?"translate-completed":"")},"localAiTranslator"===e?React.createElement("div",{id:"atfp_localAiTranslator_translate_element"}):React.createElement("div",{id:"atfp_yandex_translate_element"}))),React.createElement("div",{className:"atfp_string_container"},React.createElement("table",{className:"scrolldown",id:"stringTemplate"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",{className:"notranslate"},T("S.No","automatic-translations-for-polylang")),React.createElement("th",{className:"notranslate"},T("Source Text","automatic-translations-for-polylang")),React.createElement("th",{className:"notranslate"},T("Translation","automatic-translations-for-polylang")))),React.createElement("tbody",null,t.postDataFetchStatus&&React.createElement(React.Fragment,null,a.map(((e,a)=>React.createElement(C,{key:a+t.translatePendingStatus},void 0!==e.source&&""!==e.source.trim()&&React.createElement(React.Fragment,null,React.createElement("tr",{key:a+"tr"+t.translatePendingStatus},React.createElement("td",null,a+1),React.createElement("td",{"data-source":"source_text"},e.source),t.translatePendingStatus?React.createElement("td",{className:"translate",translate:"yes","data-key":e.id,"data-string-type":e.type},React.createElement(d,{service:t.service,content:e.source,totalString:350,currentIndex:a+1,contentKey:e.id})):React.createElement("td",{className:"translate","data-translate-status":"translated","data-key":e.id,"data-string-type":e.type},e.translatedData[t.service]))))))))))):t.postDataFetchStatus?React.createElement("p",null,T("No strings are available for translation","automatic-translations-for-polylang")):React.createElement(E,{count:1,height:"150px",width:"100%",className:"react-loading-skeleton-atfp"}))},N=t=>React.createElement("div",{className:`notice inline notice-info is-dismissible ${t.className}`},Array.isArray(t.children)?t.children.join(" "):t.children),{sprintf:R,__:j}=wp.i18n,L=t=>React.createElement("div",{className:"modal-footer",key:t.modalRender},!t.translatePendingStatus&&t.stringCount&&React.createElement(N,{className:"atfp_string_count"},R(j("Automated translation complete: %s words translated, saving valuable time and resources.","automatic-translations-for-polylang"),t.stringCount)),React.createElement("div",{className:"save_btn_cont"},React.createElement("button",{className:"notranslate save_it button button-primary",disabled:t.translatePendingStatus,onClick:t.updatePostData},j("Update Content","automatic-translations-for-polylang"))),!t.translatePendingStatus&&React.createElement("div",{className:"atfp-character-count-container"},React.createElement("p",null,"Wahooo! You have saved your valuable time via auto translating ",React.createElement("strong",null,t.characterCount)," characters using ",React.createElement("strong",null,(()=>{const e=t.service;return"yandex"===e?"Yandex Translate":"google"===e?"Google Translate":"local-ai-translator"===e?"Local AI Translator":e})()),".")));function P(){return P=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var n in a)({}).hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t},P.apply(null,arguments)}const $=t=>{const e=(0,i.select)("block-atfp/translate").getTranslationInfo().translateData[t.service]||!1,a=e?.translateStatus||!1,[n,r]=(0,o.useState)(!0),[s,c]=(0,o.useState)(""),[d,u]=(0,o.useState)(!0),[p,h]=(0,o.useState)(e?.targetCharacterCount||0);(0,o.useEffect)((()=>{t.postDataFetchStatus||t.fetchPostData({postId:t.postId,sourceLang:t.sourceLang,targetLang:t.targetLang,updatePostDataFetch:t.updatePostDataFetch,refPostData:t=>c(t)})}),[t.postDataFetchStatus,t.modalRender]);const m=e=>{"yandex"===t.service&&document.querySelector("#atfp_yandex_translate_element #yt-widget .yt-button__icon.yt-button__icon_type_right")?.click(),u(!0),r(!1)},g=()=>{const e=s;t.translatePost({postContent:e,modalClose:()=>r(!1),service:t.service}),t.pageTranslate(!0),(({provider:t,sourceLang:e,targetLang:a,postId:n})=>{const r=(0,i.select)("block-atfp/translate").getTranslationInfo(),s=r.translateData?.[t]?.targetWordCount||0,o=r.translateData?.[t]?.targetCharacterCount||0,l=r.translateData?.[t]?.timeTaken||0,c=r?.sourceWordCount||0,d=r?.sourceCharacterCount||0,u={provider:t,totalWordCount:s,totalCharacterCount:o,editorType:atfp_global_object.editor_type,date:(new Date).toISOString(),sourceWordCount:c,sourceCharacterCount:d,sourceLang:e,targetLang:a,timeTaken:l,action:atfp_global_object.update_translate_data,atfp_nonce:atfp_global_object.ajax_nonce,post_id:n};fetch(atfp_global_object.ajax_url,{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8",Accept:"application/json"},body:new URLSearchParams(u)}).then((t=>t.json())).then((t=>{console.log(t.data.message)})).catch((t=>{console.error(t)}))})({provider:t.service,sourceLang:t.sourceLang,targetLang:t.targetLang,postId:t.currentPostId})};return(0,o.useEffect)((()=>{r(!0),a&&d&&(h(e?.targetCharacterCount||0),u(!1)),setTimeout((()=>{const t=document.querySelector(".atfp_string_container");t&&(t.scrollTop=0)}))}),[t.modalRender]),React.createElement(React.Fragment,null," ",n&&React.createElement("div",{id:`atfp-${t.service}-strings-modal`,className:"modal-container",style:{display:n?"flex":"none"}},React.createElement("div",{className:"modal-content"},React.createElement(l,{modalRender:t.modalRender,setPopupVisibility:m,postContent:s,translatePendingStatus:d,pageTranslate:t.pageTranslate,service:t.service,updatePostData:g,characterCount:p}),React.createElement(x,P({},t,{updatePostContent:t=>{c(t)},contentLoading:t.contentLoading,postDataFetchStatus:t.postDataFetchStatus,translatePendingStatus:d,service:t.service,sourceLang:t.sourceLang,targetLang:t.targetLang,translateStatusHandler:()=>{const e=(0,i.select)("block-atfp/translate").getTranslationInfo().translateData[t.service]?.targetCharacterCount||0;h(e),u(!1)},modalRender:t.modalRender,translateStatus:a})),React.createElement(L,{modalRender:t.modalRender,setPopupVisibility:m,postContent:s,translatePendingStatus:d,pageTranslate:t.pageTranslate,service:t.service,updatePostData:g,characterCount:p}))))},{sprintf:A,__:D}=wp.i18n,I=t=>{const[e,a]=(0,o.useState)({}),[n,r]=(0,o.useState)(0),[i,l]=(0,o.useState)(!1),c=atfp_global_object.source_lang,d=t.targetLang,u=atfp_global_object.languageObject[c],p=atfp_global_object.languageObject[d],h=(atfp_global_object.ajax_url,atfp_global_object.atfp_url+"assets/images/"),m=["af","am","ar","az","ba","be","bg","bn","bs","ca","ceb","cs","cv","cy","da","de","el","emj","en","eo","es","et","eu","fa","fi","fr","ga","gd","gl","gu","he","hi","hr","ht","hu","hy","id","is","it","ja","jv","ka","kazlat","kk","km","kn","ko","ky","la","lb","lo","lt","lv","mg","mhr","mi","mk","ml","mn","mr","mrj","ms","mt","my","ne","nl","no","pa","pap","pl","pt","pt-BR","ro","ru","sah","si","sk","sl","sq","sr","sr-Latn","su","sv","sw","ta","te","tg","th","tl","tr","tt","udm","uk","ur","uz","uzbcyr","vi","xh","yi","zh","zu"].includes(d),g=(atfp_global_object.ajax_nonce,atfp_global_object.action_block_rules,t=>{t.preventDefault();const e=t.target;"yes"===e.dataset.value&&l(!0),e.closest("#atfp-modal-open-warning-wrapper").remove()});(0,o.useEffect)((()=>{const e=document.querySelectorAll("#atfp-modal-open-warning-wrapper .modal-content button"),a=document.querySelector(t.translateWrpSelector);a&&a.addEventListener("click",(()=>{l((t=>!t))})),e.forEach((t=>{t&&t.addEventListener("click",g)}))}),[]),(0,o.useEffect)((()=>{(async()=>{const t=await y.languageSupportedStatus(c,d,p),e=document.querySelector(".atfp-service-btn#local_ai_translator_btn");!0!==t&&"object"==typeof t&&e&&(e.disabled=!0,jQuery(e).after(t))})()}),[i]),(0,o.useEffect)((()=>{const a=e,r=a.dataset&&a.dataset.service,o=a.dataset&&a.dataset.serviceLabel,i=t.postId,l=document.getElementById("atfp_strings_model");l&&(l._reactRoot||(l._reactRoot=s.createRoot(l)),n&&l._reactRoot.render(React.createElement($,{currentPostId:t.currentPostId,postId:i,service:r,serviceLabel:o,sourceLang:c,targetLang:d,modalRender:n,pageTranslate:t.pageTranslate,postDataFetchStatus:t.postDataFetchStatus,fetchPostData:t.fetchPostData,translatePost:t.translatePost,contentLoading:t.contentLoading,updatePostDataFetch:t.updatePostDataFetch})))}),[t.postDataFetchStatus,n]);const f=async t=>{let e=t.target.classList.contains("atfp-service-btn")?t.target:t.target.closest(".atfp-service-btn");const n=e.dataset&&e.dataset.service;if(l(!1),"localAiTranslator"===n){const t=await y.languageSupportedStatus(c,d,p);if(!0!==t&&"object"==typeof t)return}r((t=>t+1)),a(e)};return React.createElement(React.Fragment,null,i&&React.createElement("div",{className:"modal-container",style:{display:i?"flex":"none"}},React.createElement("div",{className:"atfp-settings modal-content"},React.createElement("div",{className:"modal-header"},React.createElement("h2",null,D("Step 1 - Select Translation Provider","automatic-translations-for-polylang")),React.createElement("h4",null,A(D("Translate %(postType)s content from %(source)s to %(target)s","automatic-translations-for-polylang"),{postType:t.postType,source:u,target:p})),React.createElement("p",{className:"atfp-error-message",style:{marginBottom:".5rem"}},A(D("This translation widget replaces the current %(postType)s content with the original %(source)s %(postType)s and translates it into %(target)s","automatic-translations-for-polylang"),{postType:t.postType,source:u,target:p})),React.createElement("span",{className:"close",onClick:()=>l(!1)},"×")),React.createElement("hr",null),React.createElement("strong",{className:"atlt-heading"},D("Translate Using Yandex Page Translate Widget","automatic-translations-for-polylang")),React.createElement("div",{className:"inputGroup"},m?React.createElement(React.Fragment,null,React.createElement("button",{className:"atfp-service-btn translate button button-primary","data-service":"yandex","data-service-label":"Yandex Translate",onClick:f},D("Yandex Translate","automatic-translations-for-polylang")),React.createElement("br",null)):React.createElement(React.Fragment,null,React.createElement("button",{className:"atfp-service-btn translate button button-primary",disabled:!0},D("Yandex Translate","automatic-translations-for-polylang")),React.createElement("br",null),React.createElement("span",{className:"atfp-error-message"},p," ",D("language is not supported by Yandex Translate","automatic-translations-for-polylang"),".")),React.createElement("a",{href:"https://translate.yandex.com/",target:"_blank"},React.createElement("img",{className:"pro-features-img",src:`${h}powered-by-yandex.png`,alt:"powered by Yandex Translate Widget"}))),React.createElement("hr",null),React.createElement("ul",{style:{margin:"0"}},React.createElement("li",null,React.createElement("span",{style:{color:"green"}},"✔")," ",D("Unlimited Translations with Yandex Translate","automatic-translations-for-polylang")),React.createElement("li",null,React.createElement("span",{style:{color:"green"}},"✔")," ",D("No API Key Required for Yandex Translate","automatic-translations-for-polylang")),React.createElement("li",null,React.createElement("span",{style:{color:"green"}},"✔")," ",D("Supports Multiple Languages","automatic-translations-for-polylang")," - ",React.createElement("a",{href:"https://yandex.com/support2/translate-desktop/en/supported-langs",target:"_blank"},D("See Supported Languages","automatic-translations-for-polylang")))),React.createElement("hr",null),React.createElement("strong",{className:"atlt-heading"},D("Translate Using Chrome Built-in API","automatic-translations-for-polylang")),React.createElement("div",{className:"inputGroup"},React.createElement("button",{id:"local_ai_translator_btn",className:"atfp-service-btn button button-primary","data-service":"localAiTranslator","data-service-label":"Chrome Built-in API",onClick:f},D("Chrome AI Translator (Beta)","automatic-translations-for-polylang")),React.createElement("br",null),React.createElement("a",{href:"https://developer.chrome.com/docs/ai/translator-api",target:"_blank"},"Powered by ",React.createElement("img",{className:"pro-features-img",src:`${h}chrome-ai-translator.png`,alt:"powered by Chrome built-in API"})," Built-in API")),React.createElement("hr",null),React.createElement("div",{className:"modal-footer"},React.createElement("button",{className:"atfp-setting-close",onClick:()=>l(!1)},D("Close","automatic-translations-for-polylang"))))))},O="SAVE_SOURCE_TITLE",B="SAVE_TRANSLATE_TITLE",F="SAVE_SOURCE_EXCERPT",z="SAVE_TRANSLATE_EXCERPT",H="SAVE_SOURCE_CONTENT",M="SAVE_TRANSLATE_CONTENT",V="SAVE_SOURCE_META_FIELDS",Q="SAVE_TRANSLATE_META_FIELDS",W="SET_BLOCK_RULES",q="SAVE_TRANSLATE_INFO",K={title:{},excerpt:{},content:[],metaFields:{}},G=t=>({type:O,text:t}),U=(t,e)=>({type:B,text:t,provider:e}),Y=t=>({type:F,text:t}),J=(t,e)=>({type:z,text:t,provider:e}),X=(t,e)=>({type:H,text:e,id:t}),Z=(t,e,a,n)=>({type:M,text:e,id:t,source:a,provider:n}),tt=(t,e)=>({type:V,text:e,id:t}),et=(t,e,a,n)=>({type:Q,text:e,id:t,source:a,provider:n}),at=t=>({type:W,data:t}),nt=({sourceWordCount:t=null,sourceCharacterCount:e=null,timeTaken:a=null,provider:n=null,targetWordCount:r=null,targetCharacterCount:s=null,translateStatus:o=null})=>({type:q,sourceWordCount:t,sourceCharacterCount:e,timeTaken:a,targetWordCount:r,targetCharacterCount:s,provider:n,translateStatus:o}),rt=t=>{const e=new Array;return t.title.source&&e.push({id:"title",source:t.title.source,type:"title",translatedData:t.title.translatedData||{}}),t.excerpt.source&&e.push({id:"excerpt",source:t.excerpt.source,type:"excerpt",translatedData:t.excerpt.translatedData||{}}),Object.keys(t.metaFields).map((a=>{e.push({type:"metaFields",id:a,source:t.metaFields[a].source,translatedData:t.metaFields[a].translatedData||{}})})),Object.keys(t.content).map((a=>{e.push({type:"content",id:a,source:t.content[a].source,translatedData:t.content[a].translatedData||{}})})),e},st=t=>t.blockRules,ot=(t,e,a,n=null,r=null)=>["title","excerpt"].includes(e)&&t[e].source===a&&t[e].translatedData&&t[e].translatedData[r]?t[e]?.translatedData[r]||t[e]?.source:"metaFields"===e&&t.metaFields&&t.metaFields[n]&&t.metaFields[n].source===a&&t.metaFields[n].translatedData&&t.metaFields[n].translatedData[r]?void 0!==t.metaFields[n]?.translatedData[r]?t.metaFields[n]?.translatedData[r]:t.metaFields[n]?.source:"content"===e&&t.content&&t.content[n]&&t.content[n].source===a&&t.content[n].translatedData&&t.content[n].translatedData[r]?void 0!==t.content[n]?.translatedData[r]?t.content[n]?.translatedData[r]:t.content[n]?.source:a,it=t=>({sourceWordCount:t?.translationInfo?.sourceWordCount||0,sourceCharacterCount:t?.translationInfo?.sourceCharacterCount||0,translateData:t?.translationInfo?.translateData||{}}),{createReduxStore:lt,register:ct}=wp.data;ct(lt("block-atfp/translate",{reducer:(t=K,e)=>{switch(e.type){case O:return/[\p{L}\p{N}]/gu.test(e.text)?{...t,title:{...t.title,source:e.text}}:t;case B:return{...t,title:{...t.title,translatedData:{...t.title.translatedData||[],[e.provider]:e.text}}};case F:return/[\p{L}\p{N}]/gu.test(e.text)?{...t,excerpt:{...t.excerpt,source:e.text}}:t;case z:return{...t,excerpt:{...t.excerpt,translatedData:{...t.excerpt.translatedData||[],[e.provider]:e.text}}};case H:return/[\p{L}\p{N}]/gu.test(e.text)?{...t,content:{...t.content,[e.id]:{...t.content[e.id]||[],source:e.text}}}:t;case M:return t.content[e.id].source===e.source?{...t,content:{...t.content,[e.id]:{...t.content[e.id]||[],translatedData:{...t.content[e.id].translatedData||[],[e.provider]:e.text}}}}:t;case V:return/[\p{L}\p{N}]/gu.test(e.text)?{...t,metaFields:{...t.metaFields,[e.id]:{...t.metaFields[e.id]||[],source:e.text}}}:t;case Q:return{...t,metaFields:{...t.metaFields,[e.id]:{...t.metaFields[e.id]||[],translatedData:{...t.metaFields[e.id].translatedData||[],[e.provider]:e.text}}}};case W:return{...t,blockRules:e.data};case q:const a={};return e.sourceWordCount&&(a.sourceWordCount=e.sourceWordCount),e.sourceCharacterCount&&(a.sourceCharacterCount=e.sourceCharacterCount),(e.targetWordCount||e.targetCharacterCount||e.translateStatus||e.timeTaken)&&e.provider&&(a.translateData={...t.translationInfo?.translateData||{},[e.provider]:{...t.translationInfo?.translateData?.[e.provider]||{},...e.targetWordCount&&{targetWordCount:e.targetWordCount},...e.targetCharacterCount&&{targetCharacterCount:e.targetCharacterCount},...e.translateStatus&&{translateStatus:e.translateStatus},...e.timeTaken&&{timeTaken:e.timeTaken}}}),{...t,translationInfo:{...t.translationInfo,...a}};default:return t}},actions:n,selectors:r}));const dt=(t,e,a,n)=>{const r=(t,e)=>{Object.keys(e).map((a=>{let r=e;r=r[a];const s=new Array(...t,a);n(s,r)}))};Object.getPrototypeOf(e)===Array.prototype?((t,e)=>{const s=new Array(...t);let o=a;s.forEach((t=>{o=o[t]})),[null,void 0].includes(o)||(Object.getPrototypeOf(o)!==Object.prototype?(Object.getPrototypeOf(o)===Array.prototype&&o.forEach(((t,a)=>{const r=new Array;s.forEach((t=>{r.push(t)})),r.push(a),n(r,e[0])})),"object"!=typeof o||r(t,e[0])):r(t,e[0]))})(t,e):Object.getPrototypeOf(e)===Object.prototype&&r(t,e)},{dispatch:ut}=wp.data,pt=(t,e)=>{Object.keys(e.AtfpBlockParseRules).includes(t.name)&&((t,e,a)=>{const n=Object.values(a),r=(a,n)=>{if(!0!==n)dt(a,n,e,r);else{const n=new Array(...a),r=new Array;let s=e,o=t;n.forEach((t=>{r.push(t),o+=`atfp${t}`,s=s[t]}));let i=s;if(i instanceof wp.richText.RichTextData&&(i=i.originalHTML),void 0!==i&&""!==i.trim()){let t=o.replace(/[^\p{L}\p{N}]/gu,"");if(!/[\p{L}\p{N}]/gu.test(i))return!1;ut("block-atfp/translate").contentSaveSource(t,i)}}};n.forEach((t=>{Object.keys(t).forEach((e=>{const a=new Array(e);r(a,t[e])}))}))})(t.clientId,t.attributes,e.AtfpBlockParseRules[t.name])},ht=(t,e)=>{t.forEach((t=>{pt(t,e),t.innerBlocks&&ht(t.innerBlocks,e)}))},mt=(t,e)=>{Object.keys(t).forEach((a=>{if("content"===a)((t,e)=>{Object.values(t).forEach((t=>{pt(t,e),t.innerBlocks&&ht(t.innerBlocks,e)}))})(t[a],e);else if("metaFields"===a)Object.keys(t[a]).forEach((e=>{Object.keys(u).includes(e)&&"string"===u[e].type&&""!==t[a][e][0]&&void 0!==t[a][e][0]&&ut("block-atfp/translate").metaFieldsSaveSource(e,t[a][e][0])}));else if(["title","excerpt"].includes(a)&&t[a]&&""!==t[a].trim()){const e=`${a}SaveSource`;ut("block-atfp/translate")[e](t[a])}}))},gt=async t=>{const{__}=wp.i18n,{parse:e}=wp.blocks,{dispatch:a}=wp.data,n=atfp_global_object.ajax_url;let r={};const s={atfp_nonce:atfp_global_object.ajax_nonce,action:atfp_global_object.action_block_rules};await fetch(n,{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8",Accept:"application/json"},body:new URLSearchParams(s)}).then((t=>t.json())).then((t=>{r=JSON.parse(t.data.blockRules),a("block-atfp/translate").setBlockRules(r)})).catch((t=>{console.error("Error fetching post content:",t)}));const o={postId:parseInt(t.postId),local:t.targetLang,current_local:t.sourceLang,atfp_nonce:atfp_global_object.ajax_nonce,action:atfp_global_object.action_fetch};await fetch(n,{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8",Accept:"application/json"},body:new URLSearchParams(o)}).then((t=>t.json())).then((a=>{const n=a.data;n.content&&""!==n.content.trim()&&(n.content=e(n.content)),mt(n,r),t.refPostData(n),t.updatePostDataFetch(!0)})).catch((t=>{console.error("Error fetching post content:",t)}))},ft=(t,e,a,n)=>{const{createBlock:r}=wp.blocks,{name:s,attributes:o}=t;let i={...o},l=t,c="";return Object.keys(a.AtfpBlockParseRules).includes(t.name)&&(l=((t,e,a)=>{const{select:n}=wp.data,r=Object.values(e),s=t.attributes,o=t.clientId,i=(e,r)=>{if(!0!==r)dt(e,r,s,i);else{const r=new Array(...e),i=new Array;let l=s,c=o;r.forEach((t=>{i.push(t),c+=`atfp${t}`,l=l[t]}));let d=l;if(d instanceof wp.richText.RichTextData&&(d=d.originalHTML),void 0!==d&&""!==d.trim()){let e=c.replace(/[^\p{L}\p{N}]/gu,""),s="";s=/[\p{L}\p{N}]/gu.test(d)?n("block-atfp/translate").getTranslatedString("content",d,e,a):d,t.attributes=((t,e,a)=>{const n={...t};let r=n;for(let t=0;t<e.length-1;t++)Object.getPrototypeOf(r[e[t]])===Array.prototype?r[e[t]]=[...r[e[t]]]:r[e[t]]={...r[e[t]]},r=r[e[t]];return r[e[e.length-1]]instanceof wp.richText.RichTextData?r[e[e.length-1]]=a.replace(/(?<!\\)"|\\"/g,"'"):r[e[e.length-1]]=a,n})(t.attributes,r,s)}}};return r.forEach((t=>{Object.keys(t).forEach((e=>{const a=new Array(e);i(a,t[e])}))})),t})(t,a.AtfpBlockParseRules[t.name],n),i=l.attributes),c=r(s,i,e),c},_t=(t,e,a)=>{let n=t.innerBlocks.map((t=>{if(t.name)return _t(t,e,a)}));return ft(t,n,e,a)},yt=t=>{const{editPost:e}=(0,i.dispatch)("core/editor"),{modalClose:a,postContent:n,service:r}=t;(()=>{const t={};Object.keys(n).filter((t=>["title","excerpt"].includes(t))).forEach((e=>{const a=n[e];if(""!==a.trim()){const n=(0,i.select)("block-atfp/translate").getTranslatedString(e,a,null,r);t[e]=n}})),e(t)})(),(()=>{const t=n.metaFields;Object.keys(t).forEach((a=>{if(Object.keys(u).includes(a)&&"string"===u[a].type){const n=(0,i.select)("block-atfp/translate").getTranslatedString("metaFields",t[a][0],a,r);a.startsWith("_yoast_wpseo_")?(t=>{if(!(0,i.dispatch)("yoast-seo/editor"))return;const{updateData:e,setFocusKeyword:a,setBreadcrumbsTitle:n,setFacebookPreviewTitle:r,setFacebookPreviewDescription:s,setTwitterPreviewTitle:o,setTwitterPreviewDescription:l}=(0,i.dispatch)("yoast-seo/editor"),{key:c,value:d}=t;switch(c){case"_yoast_wpseo_focuskw":a&&a(d);break;case"_yoast_wpseo_title":e&&e({title:d});break;case"_yoast_wpseo_metadesc":e&&e({description:d});break;case"_yoast_wpseo_bctitle":n&&n(d);break;case"_yoast_wpseo_opengraph-title":r&&r(d);break;case"_yoast_wpseo_opengraph-description":s&&s(d);break;case"_yoast_wpseo_twitter-title":o&&o(d);break;case"_yoast_wpseo_twitter-description":l&&l(d)}})({key:a,value:n}):a.startsWith("rank_math_")?(t=>{if(!(0,i.dispatch)("rank-math"))return;const{updateKeywords:e,updateTitle:a,updateDescription:n,updateBreadcrumbTitle:r,updateFacebookTitle:s,updateFacebookDescription:o,updateTwitterTitle:l,updateTwitterDescription:c}=(0,i.dispatch)("rank-math"),{key:d,value:u}=t;switch(d){case"rank_math_focus_keyword":e&&e(u);break;case"rank_math_title":a&&a(u);break;case"rank_math_description":n&&n(u);break;case"rank_math_breadcrumb_title":r&&r(u);break;case"rank_math_facebook_title":s&&s(u);break;case"rank_math_facebook_description":o&&o(u);break;case"rank_math_twitter_title":l&&l(u);break;case"rank_math_twitter_description":c&&c(u)}})({key:a,value:n}):a.startsWith("_seopress_")?(async t=>{const{key:e,value:a}=t,n=e.replace(/^_/,"")+"_meta";if(document.querySelector("#"+n))switch(e){case"_seopress_titles_title":case"_seopress_titles_desc":case"_seopress_social_fb_title":case"_seopress_social_fb_desc":case"_seopress_social_twitter_title":case"_seopress_social_twitter_desc":jQuery(`#${n}`).val(a),jQuery(`#${n}`).trigger("change");break;case"_seopress_analysis_target_kw":window.target_kw&&window.target_kw instanceof window.Tagify&&window.target_kw.DOM.originalInput.id===n?window.target_kw.addTags(a):(jQuery("#"+n).val(a),jQuery("#"+n).trigger("change"))}})({key:a,value:n}):e({meta:{[a]:n}})}}))})(),(()=>{const t=n.content;t.length<=0||Object.values(t).forEach((t=>{((t,e)=>{const{select:a}=wp.data,n=a("block-atfp/translate").getBlockRules(),{dispatch:r}=wp.data,{name:s}=t;if(s){let a=t.innerBlocks.map((t=>{if(t.name)return _t(t,n,e)}));const s=ft(t,a,n,e);r("core/block-editor").insertBlock(s)}})(t,r)}))})(),a()},bt=({characterCount:t=0,url:e=""})=>{const[a,n]=(0,c.useState)(!1),[r,s]=(0,c.useState)(!1);return(0,c.useEffect)((()=>{const t=document.querySelector('button.atfp-translate-button[name="atfp_meta_box_translate"],input#atfp-translate-button[name="atfp_meta_box_translate"]');if(t)return t.addEventListener("click",(()=>{n(!0),s(!0)})),()=>{t.removeEventListener("click",(()=>{}))}}),[]),a?React.createElement("div",{id:"atfp-pro-notice-wrapper",className:r?"atfp-active":""},React.createElement("div",{className:"atfp-pro-notice"},React.createElement("div",{className:"atfp-notice-header"},React.createElement("h2",null,"AI Translation for Polylang Pro Notice"),React.createElement("button",{className:"atfp-close-button",onClick:()=>n(!1),"aria-label":"Close Notice"},"✖")),React.createElement("div",{className:"atfp-notice-content"},React.createElement("p",null,"You have reached the character limit of ",React.createElement("strong",null,(o=t)>=1e6?(o/1e6).toFixed(1)+"M":o>=1e3?(o/1e3).toFixed(1)+"K":o)," for your translations. To continue translating beyond this limit, please consider upgrading to AI Translation for Polylang Pro.")),React.createElement("div",{className:"atfp-notice-footer"},React.createElement("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"atfp-upgrade-button"},"Upgrade to Pro")))):null;var o},vt=async t=>{const e=atfp_global_object.elementorData&&"string"==typeof atfp_global_object.elementorData?JSON.parse(atfp_global_object.elementorData):atfp_global_object.elementorData,a=["content_width","title_size","font_size","margin","padding","background","border","color","text_align","font_weight","font_family","line_height","letter_spacing","text_transform","border_radius","box_shadow","opacity","width","height","display","position","z_index","visibility","align","max_width","content_typography_typography","flex_justify_content","title_color","description_color","email_content"],n=t=>{const e=t.id,r=t.settings;if("object"==typeof r&&null!==r){const t=["title","description","editor","text","content","label"];Object.keys(r).forEach((n=>{if(!a.some((t=>n.toLowerCase().includes(t)))){if(t.some((t=>n.toLowerCase().includes(t)))&&"string"==typeof r[n]&&""!==r[n].trim()){const t=n+"_atfp_"+e;(0,i.dispatch)("block-atfp/translate").contentSaveSource(t,r[n])}Array.isArray(r[n])&&r[n].forEach(((r,s)=>{"object"==typeof r&&null!==r&&Object.keys(r).forEach((o=>{if(!a.includes(o.toLowerCase())&&t.some((t=>o.toLowerCase().includes(t)))&&"string"==typeof r[o]&&""!==r[o].trim()){const t=`${n}[${s}].${o}_atfp_`+e;(0,i.dispatch)("block-atfp/translate").contentSaveSource(t,r[o])}}))}))}}))}t.elements&&Array.isArray(t.elements)&&t.elements.forEach((t=>{n(t)}))};e.map((t=>n(t))),t.refPostData(e),t.updatePostDataFetch(!0)},wt=(t,e)=>{for(const a of t){if(a.get("id")===e)return a;const t=a.get("elements").models,n=wt(t,e);if(n)return n}return null},St=({postContent:t,modalClose:e,service:a})=>{const n=elementor.config.document.id,r=[],s=["content_width","title_size","font_size","margin","padding","background","border","color","text_align","font_weight","font_family","line_height","letter_spacing","text_transform","border_radius","box_shadow","opacity","width","height","display","position","z_index","visibility","align","max_width","content_typography_typography","flex_justify_content","title_color","description_color","email_content"],o=t=>{const e=t.id,n=t.settings;if("object"==typeof n&&null!==n){const t=["title","description","editor","text","content","label"];Object.keys(n).forEach((o=>{if(!s.some((t=>o.toLowerCase().includes(t)))){if(t.some((t=>o.toLowerCase().includes(t)))&&"string"==typeof n[o]&&""!==n[o].trim()){const t=o+"_atfp_"+e,s=(0,i.select)("block-atfp/translate").getTranslatedString("content",n[o],t,a);r.push({ID:e,key:o,translatedContent:s})}Array.isArray(n[o])&&n[o].forEach(((n,l)=>{"object"==typeof n&&null!==n&&Object.keys(n).forEach((c=>{if(!s.includes(c.toLowerCase())&&t.some((t=>c.toLowerCase().includes(t)))&&"string"==typeof n[c]&&""!==n[c].trim()){const t=`${o}[${l}].${c}`,s=t+"_atfp_"+e,d=(0,i.select)("block-atfp/translate").getTranslatedString("content",n[c],s,a);r.push({ID:e,key:t,translatedContent:d})}}))}))}}))}t.elements&&Array.isArray(t.elements)&&t.elements.forEach((t=>{o(t)}))};t.map((t=>o(t))),(t=>{t.forEach((t=>{const e=wt(elementor.elements.models,t.ID);if(e){const a=e.get("settings");a.get(t.key)&&a.set(t.key,t.translatedContent);const n=t.key.match(/(.+)\[(\d+)\]\.(.+)/);if(n){const[e,r,s,o]=n,i=a.get(r);Array.isArray(i.models)&&i.models[s]&&(i.models[s].attributes[o]=t.translatedContent,a.set(r,i))}}})),$e.internal("document/save/set-is-modified",{status:!0})})(r);const l=JSON.stringify(elementor.elements.toJSON());e(),fetch(atfp_global_object.ajax_url,{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8",Accept:"application/json"},body:new URLSearchParams({action:atfp_global_object.update_elementor_data,post_id:n,elementor_data:l,atfp_nonce:atfp_global_object.ajax_nonce})}).then((t=>t.json())).then((t=>{if(t.success){const t=document.querySelector('.atfp-translate-button[name="atfp_meta_box_translate"]');t&&t.setAttribute("title","Translation process completed successfully."),elementor.reloadPreview()}else console.error("Failed to update Elementor data:",t.data)})).catch((t=>{console.error("Error updating Elementor data:",t)}))},Et=window.atfp_global_object.editor_type,Tt=()=>{let t=new Array;t.push('\x3c!-- The Modal --\x3e<div id="atfp-setting-modal"></div>','<div id="atfp_strings_model" class="modal atfp_custom_model"></div>'),t.forEach((t=>{document.body.insertAdjacentHTML("beforeend",t)}))},kt=()=>{const[t,e]=(0,c.useState)(!1),a=window.atfp_global_object.target_lang,n=window.atfp_global_object.parent_post_id,r=window.atfp_global_object.current_post_id,s=window.atfp_global_object.post_type;let o,i,l;"elementor"===Et?(l='button.atfp-translate-button[name="atfp_meta_box_translate"]',o=St,i=vt):"gutenberg"===Et&&(l='input#atfp-translate-button[name="atfp_meta_box_translate"]',o=yt,i=gt);const[d,u]=(0,c.useState)(!1),[p,h]=(0,c.useState)(!0);return(0,c.useEffect)((()=>{if(t){const t=document.querySelector(l);t&&(t.disabled=!0)}}),[t]),React.createElement(React.Fragment,null,!t&&React.createElement(I,{contentLoading:p,updatePostDataFetch:t=>{u(t),h(!1)},postDataFetchStatus:d,pageTranslate:t=>{e(t)},postId:n,currentPostId:r,targetLang:a,postType:s,fetchPostData:async t=>{await i(t);const e=wp.data.select("block-atfp/translate").getTranslationEntry();let a=0,n=0;e.map((t=>{const e=t.source?t.source:"",r=e.trim().split(/\s+/).filter((t=>/[^\p{L}\p{N}]/.test(t))).length,s=e.length;a+=s,n+=r})),wp.data.dispatch("block-atfp/translate").translationInfo({sourceWordCount:n,sourceCharacterCount:a})},translatePost:o,translateWrpSelector:l}))},Ct=()=>{const t=jQuery(".MuiButtonGroup-root.MuiButtonGroup-contained").parent(),e=jQuery(t).find(".elementor-button.atfp-translate-button");if(t.length>0&&0===e.length){const e=jQuery('<button class="elementor-button atfp-translate-button" name="atfp_meta_box_translate">Translate</button>');if(t.prepend(e),$e.internal("document/save/set-is-modified",{status:!0}),!window.atfp_global_object.translation_data||!window.atfp_global_object.translation_data.total_string_count)return e.attr("disabled","disabled"),void e.attr("title","Translation data not found.");const a=parseInt(window.atfp_global_object.translation_data.total_character_count);if(a>5e5){const t=document.createElement("div");return t.id="atfp-pro-notice",document.body.appendChild(t),void s.createRoot(document.getElementById("atfp-pro-notice")).render(React.createElement(bt,{characterCount:a,url:window.atfp_global_object.pro_version_url||""}))}if(""===window.atfp_global_object.elementorData||window.atfp_global_object.elementorData.length<1||elementor.elements.length<1)return e.attr("disabled","disabled"),void e.attr("title","Translation is not available because there is no Elementor data.");Tt(),s.createRoot(document.getElementById("atfp-setting-modal")).render(React.createElement(kt,null))}};"gutenberg"===Et&&window.addEventListener("load",(()=>{Tt();const t=jQuery('input#atfp-translate-button[name="atfp_meta_box_translate"]');if(!window.atfp_global_object.translation_data||!window.atfp_global_object.translation_data.total_string_count)return t.attr("disabled","disabled"),void t.attr("title","Translation data not found.");const e=parseInt(window.atfp_global_object.translation_data.total_character_count);if(e>5e5){const t=document.createElement("div");return t.id="atfp-pro-notice",document.body.appendChild(t),void s.createRoot(document.getElementById("atfp-pro-notice")).render(React.createElement(bt,{characterCount:e,url:window.atfp_global_object.pro_version_url||""}))}(()=>{const t=document.getElementById("atfp-setting-modal"),e=(()=>{const t=window.atfp_global_object.post_type,e=window.atfp_global_object.target_lang,a=atfp_global_object.languageObject[e],n=document.createElement("div");return n.id="atfp-modal-open-warning-wrapper",n.innerHTML=`\n    <div class="modal-container" style="display: flex">\n      <div class="modal-content">\n        <p>Would you like to duplicate your original ${t} content and have it automatically translated into ${a}?</p>\n        <div>\n          <button data-value="yes">Yes</button>\n          <button data-value="no">No</button>\n        </div>\n      </div>\n    </div>`,n})();document.body.insertBefore(e,t)})(),s.createRoot(document.getElementById("atfp-setting-modal")).render(React.createElement(kt,null))})),"elementor"===Et&&jQuery(window).on("elementor:init",(function(){elementor.on("document:loaded",Ct)}))})();